{% extends 'base.html' %}
{% block content %}

<div class="card" style="max-width:400px;">
<h2>Pay Rent</h2>
<button id="pay-btn">Pay â‚¹{{ amount|floatformat:0 }}</button>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
  "key": "{{ razorpay_key }}",
  "amount": "{{ amount }}",
  "currency": "INR",
  "name": "Smart Real Estate",
  "order_id": "{{ order_id }}",
  "handler": function (response){
    var form=document.createElement("form");
    form.method="POST";
    form.action="{% url 'payment_success' %}";
    ["razorpay_payment_id","razorpay_order_id","razorpay_signature"].forEach(f=>{
      var i=document.createElement("input");
      i.type="hidden";i.name=f;i.value=response[f];
      form.appendChild(i);
    });
    document.body.appendChild(form);form.submit();
  }
};
document.getElementById("pay-btn").onclick=function(e){
  new Razorpay(options).open();e.preventDefault();
}
</script>

{% endblock %}
